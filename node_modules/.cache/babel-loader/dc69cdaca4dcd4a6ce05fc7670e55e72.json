{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/sagardalal/Desktop/Desktop/ReactJS/social-app-github/src/containers/create-post/index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useEffect, useState } from \"react\";\nimport { SignInBtn } from \"../../components\";\nimport { UserContext } from \"../../contexts/user\";\nimport \"./style.css\";\nimport AddAPhotoIcon from \"@material-ui/icons/AddAPhoto\";\nimport makeId from \"../../helper/functions\";\nimport { db, storage } from \"../../firebase\";\nimport firebase from \"firebase\";\nimport { DarkModeContext } from \"../../contexts/darkmode\";\nexport default function CreatePost() {\n  _s();\n\n  const [user, setUser] = useContext(UserContext).user;\n  const [caption, setCaption] = useState(\"\");\n  const [image, setImage] = useState(null);\n  const [progress, setProgress] = useState(0);\n  const [DarkMode, setDarkMode] = useContext(DarkModeContext).DarkMode;\n  var createPost__loggedInCss = \"createPost__loggedIn\";\n  var createPost__textarea = \"createPost__textarea\";\n\n  if (DarkMode) {\n    createPost__textarea = \"createPost__textarea dark\";\n    createPost__loggedInCss = \"createPost__loggedIn dark\";\n  }\n\n  firebase.auth().onAuthStateChanged(function (user) {\n    setUser(user);\n  });\n\n  const handleChange = e => {\n    if (e.target.files[0]) {\n      setImage(e.target.files[0]);\n      var selectedImageSrc = URL.createObjectURL(e.target.files[0]);\n      var imagePreview = document.getElementById(\"image-preview\");\n      imagePreview.src = selectedImageSrc;\n      imagePreview.style.display = \"block\";\n    }\n  };\n\n  const handleUpload = () => {\n    if (image) {\n      var imageName = makeId(10);\n      const uploadTask = storage.ref(`images/${imageName}.jpg`).put(image);\n      uploadTask.on(\"state_changed\", snapshot => {\n        //progress function\n        const progress = Math.round(snapshot.bytesTransferred / snapshot.totalBytes * 100);\n        setProgress(progress);\n      }, error => {\n        console.log(error);\n      }, () => {\n        //get download url and upload the post info\n        storage.ref(\"images\").child(`${imageName}.jpg`).getDownloadURL().then(imageUrl => {\n          db.collection(\"posts\").add({\n            timestamp: firebase.firestore.Timestamp.now(),\n            caption: caption,\n            photoUrl: imageUrl,\n            username: user.email.replace(\"@gmail.com\", \"\"),\n            profileUrl: user.photoURL\n          });\n        });\n        setCaption(\"\");\n        setProgress(0);\n        setImage(null);\n        document.getElementById(\"image-preview\").style.display = \"none\";\n        console.log(\"image nulled\");\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"createPost\",\n    children: user ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: createPost__loggedInCss,\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Create Post\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"createPost__loggedInCenter\",\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          placeholder: \"enter caption here..\",\n          className: createPost__textarea,\n          rows: \"3\",\n          value: caption,\n          onChange: e => setCaption(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"createPost__imagePreview\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            id: \"image-preview\",\n            alt: \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"creatPost__loggedInBottom\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"createPost__imageUpload\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"fileInput\",\n            children: /*#__PURE__*/_jsxDEV(AddAPhotoIcon, {\n              style: {\n                cursor: \"pointer\",\n                fontSize: \"20px\"\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 105,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            id: \"fileInput\",\n            type: \"file\",\n            accept: \"image/*\",\n            onChange: handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"createPost__uploadBtn\",\n          onClick: handleUpload,\n          style: {\n            color: DarkMode ? caption ? \"#FFFFFF\" : \"lightgrey\" : caption ? \"#000\" : \"lightgrey\"\n          },\n          children: `Upload ${progress != 0 ? progress : \"\"}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 86,\n    columnNumber: 5\n  }, this);\n}\n\n_s(CreatePost, \"YwjQrxM3kKiPS+Q04XPGbEXNh7U=\");\n\n_c = CreatePost;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreatePost\");","map":{"version":3,"sources":["/Users/sagardalal/Desktop/Desktop/ReactJS/social-app-github/src/containers/create-post/index.js"],"names":["React","useContext","useEffect","useState","SignInBtn","UserContext","AddAPhotoIcon","makeId","db","storage","firebase","DarkModeContext","CreatePost","user","setUser","caption","setCaption","image","setImage","progress","setProgress","DarkMode","setDarkMode","createPost__loggedInCss","createPost__textarea","auth","onAuthStateChanged","handleChange","e","target","files","selectedImageSrc","URL","createObjectURL","imagePreview","document","getElementById","src","style","display","handleUpload","imageName","uploadTask","ref","put","on","snapshot","Math","round","bytesTransferred","totalBytes","error","console","log","child","getDownloadURL","then","imageUrl","collection","add","timestamp","firestore","Timestamp","now","photoUrl","username","email","replace","profileUrl","photoURL","value","cursor","fontSize","color"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\nimport { SignInBtn } from \"../../components\";\nimport { UserContext } from \"../../contexts/user\";\nimport \"./style.css\";\n\nimport AddAPhotoIcon from \"@material-ui/icons/AddAPhoto\";\nimport makeId from \"../../helper/functions\";\nimport { db, storage } from \"../../firebase\";\n\nimport firebase from \"firebase\";\nimport { DarkModeContext } from \"../../contexts/darkmode\";\n\nexport default function CreatePost() {\n  const [user, setUser] = useContext(UserContext).user;\n  const [caption, setCaption] = useState(\"\");\n  const [image, setImage] = useState(null);\n  const [progress, setProgress] = useState(0);\n  const [DarkMode, setDarkMode] = useContext(DarkModeContext).DarkMode;\n  var createPost__loggedInCss = \"createPost__loggedIn\";\n  var createPost__textarea = \"createPost__textarea\";\n  if (DarkMode) {\n    createPost__textarea = \"createPost__textarea dark\";\n    createPost__loggedInCss = \"createPost__loggedIn dark\";\n  }\n\n  firebase.auth().onAuthStateChanged(function (user) {\n    setUser(user);\n  });\n\n  const handleChange = (e) => {\n    if (e.target.files[0]) {\n      setImage(e.target.files[0]);\n\n      var selectedImageSrc = URL.createObjectURL(e.target.files[0]);\n\n      var imagePreview = document.getElementById(\"image-preview\");\n\n      imagePreview.src = selectedImageSrc;\n      imagePreview.style.display = \"block\";\n    }\n  };\n\n  const handleUpload = () => {\n    if (image) {\n      var imageName = makeId(10);\n      const uploadTask = storage.ref(`images/${imageName}.jpg`).put(image);\n      uploadTask.on(\n        \"state_changed\",\n        (snapshot) => {\n          //progress function\n\n          const progress = Math.round(\n            (snapshot.bytesTransferred / snapshot.totalBytes) * 100\n          );\n          setProgress(progress);\n        },\n        (error) => {\n          console.log(error);\n        },\n        () => {\n          //get download url and upload the post info\n          storage\n            .ref(\"images\")\n            .child(`${imageName}.jpg`)\n            .getDownloadURL()\n            .then((imageUrl) => {\n              db.collection(\"posts\").add({\n                timestamp: firebase.firestore.Timestamp.now(),\n                caption: caption,\n                photoUrl: imageUrl,\n                username: user.email.replace(\"@gmail.com\", \"\"),\n                profileUrl: user.photoURL,\n              });\n            });\n          setCaption(\"\");\n          setProgress(0);\n          setImage(null);\n          document.getElementById(\"image-preview\").style.display = \"none\";\n          console.log(\"image nulled\");\n        }\n      );\n    }\n  };\n\n  return (\n    <div className=\"createPost\">\n      {user ? (\n        <div className={createPost__loggedInCss}>\n          <p>Create Post</p>\n          <div className=\"createPost__loggedInCenter\">\n            <textarea\n              placeholder=\"enter caption here..\"\n              className={createPost__textarea}\n              rows=\"3\"\n              value={caption}\n              onChange={(e) => setCaption(e.target.value)}\n            ></textarea>\n            <div className=\"createPost__imagePreview\">\n              <img id=\"image-preview\" alt=\"\" />\n            </div>\n          </div>\n          <div className=\"creatPost__loggedInBottom\">\n            <div className=\"createPost__imageUpload\">\n              <label htmlFor=\"fileInput\">\n                <AddAPhotoIcon\n                  style={{ cursor: \"pointer\", fontSize: \"20px\" }}\n                />\n              </label>\n\n              <input\n                id=\"fileInput\"\n                type=\"file\"\n                accept=\"image/*\"\n                onChange={handleChange}\n              ></input>\n            </div>\n            <button\n              className=\"createPost__uploadBtn\"\n              onClick={handleUpload}\n              style={{\n                color: DarkMode\n                  ? caption\n                    ? \"#FFFFFF\"\n                    : \"lightgrey\"\n                  : caption\n                  ? \"#000\"\n                  : \"lightgrey\",\n              }}\n            >\n              {`Upload ${progress != 0 ? progress : \"\"}`}\n            </button>\n          </div>\n        </div>\n      ) : (\n        <div></div>\n      )}\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}